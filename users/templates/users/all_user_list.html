{% extends 'includes/base.html' %}
{% load static %}
{% load friendshiptags %}

{% block head_title %}Freelancers{% endblock %}

{% block post_CSS %}
<link rel="stylesheet" href="{% static 'users/css/users.css' %}">
{% endblock %}

{% block content %}
<section class="light-page screen-height section-with-padding">
    <div class="nav-top-padding"></div>
    <div class="container-fluid w-100 m-auto py-5 px-0 centered-col-large-page">
        <h1 class="header-underline-after">Discover New Freelancers</h1>
        <div class="search-row py-5">
            <div class="card search-box-card muted">
                <h2>Filter your search</h2>
                <form action="{% url 'all_users' %}" id="user_search_form" method="POST">{%csrf_token%}
                    <div class="input-row d-flex justify-content-between mt-3">
                        <div class="fieldset">
                            <label for="user_search" class="mb-3">By Keyword</label>
                            <input type="text" name="user_search" id="user_search"
                                placeholder="Search by name, location, skill, description">
                        </div>
                        <div class="fieldset" id="industry_search">
                            <label for="industry" class="mb-3">By Industry</label>
                            <div id="ind_select_profile_edit"></div>
                        </div>
                    </div>
                    <div class="d-flex search-button-wrapper justify-content-between flex-wrap">
                        <button type="submit" class="btn primary-btn large">Filter Results</button>
                        <a href="{% url 'all_users' %}" class="btn primary-btn-outline-color">Clear Results</a>
                    </div>
                </form>
            </div>
        </div>


        <div id="search_results" class="page-results flex-wrap">
            {% for user in users %}
            <div class="card user-card muted">
                <div class="d-flex flex-wrap">
                    <div class="prf-img-preview">
                        <img class="prf-img-preview" src="/media/{{user.profile_image}}"
                            alt="{{user.first_name}} {{user.last_name}}'s profile image"
                            onload="specImageOrientation(this);">
                    </div>
                    <!-- TODO remove default testing input -->
                    <div class="user-details-mast">
                        <h3>{{user.first_name}} {{user.last_name}}</h3>
                        <p>{{user.job_role}}</p>
                        <p>{{user.location}}</p>
                        <span class="user-ind-pill green">{{user.industry}}</span>
                    </div>
                </div>
                <hr>
                <div class="user-details-bottom">
                    <p class="user-skills">{{user.skills}}</p>
                    <p class="pt-3">{{user.description}}</p>
                </div>
                <div class="user-cta d-flex flex-wrap justify-content-between mt-3">

                    {% for req in pending_friend_reqs %}

                    {% if req.to_user == user %}
                    <button class="req-sent-btn btn primary-btn px-3 py-1 m-1" onclick="cancel_friend('{{user.pk}}')"
                        value="{{user.pk}}">Connection Request Sent</button>
                    {% else %}
                    {% endif %}
                    {% endfor %}
                    <button class="send-connection-btn btn primary-btn px-3 py-1 m-1" onclick="add_friend('{{user.pk}}')"
                        value="{{user.pk}}">Send Connection Request</button>


                    <button class="btn primary-btn-outline-color px-3 py-1 m-1">Remove Connection</button>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <div class="fixed-40"></div>

</section>

{{ industries|json_script:"all_inds" }}
<script src="{% static 'users/js/options_multiselect.js' %}" type="text/javascript"></script>
<script src="{% static 'users/js/users.js' %}" type="text/javascript"></script>


{% endblock %}